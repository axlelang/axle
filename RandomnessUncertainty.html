<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.18.2 + Helium Theme" />
    <title>Randomness and Uncertainty</title>
    
    
      <meta name="description" content="axle-docs"/>
    
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css">
    
    <link rel="stylesheet" type="text/css" href="helium/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="helium/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="css/main.scss" />
    <script src="helium/laika-helium.js"></script>
    <script src="js/ga.js"></script>
    
    
    <script> /* for avoiding page load transitions */ </script>
  </head>

  <body>

    <header id="top-bar">

      <div class="row">
        <a id="nav-icon">
          <i class="icofont-laika" title="Navigation">&#xefa2;</i>
        </a>
        
      </div>
  
      <a class="icon-link" href="index.html"><i class="icofont-laika" title="Home">&#xef47;</i></a>
      
      <span class="row links"></span>
      
    </header>

    <nav id="sidebar">

      <div class="row">
        
      </div>
      
      <ul class="nav-list">
        <li class="level1"><a href="table-of-content.html">Contents</a></li>
        <li class="level1"><a href="downloads.html">Documentation Downloads</a></li>
        <li class="level1"><a href="Introduction.html">Introduction</a></li>
        <li class="level1"><a href="Foundation.html">Foundation</a></li>
        <li class="level1"><a href="Math.html">Math</a></li>
        <li class="level1"><a href="Units.html">Units of Measurement</a></li>
        <li class="level1"><a href="Visualization.html">Visualization</a></li>
        <li class="level1"><a href="GraphTheory.html">Graph Theory</a></li>
        <li class="level1 active"><a href="#">Randomness and Uncertainty</a></li>
        <li class="level1"><a href="GameTheory.html">Game Theory</a></li>
        <li class="level1"><a href="ChaosTheory.html">Chaos Theory</a></li>
        <li class="level1"><a href="MachineLearning.html">Machine Learning</a></li>
        <li class="level1"><a href="Biology.html">Biology</a></li>
        <li class="level1"><a href="Text.html">Text</a></li>
        <li class="level1"><a href="QuantumCircuits.html">Quantum Circuits</a></li>
        <li class="level1"><a href="Appendix.html">Appendix</a></li>
      </ul>
      
    </nav>

    <div id="container">

      <nav id="page-nav">
        <p class="header"><a href="#">Randomness and Uncertainty</a></p>
        
        <ul class="nav-list">
          <li class="level1"><a href="#probability-model">Probability Model</a></li>
          <li class="level2"><a href="#imports">Imports</a></li>
          <li class="level2"><a href="#creating-probability-models">Creating Probability Models</a></li>
          <li class="level2"><a href="#sampler">Sampler</a></li>
          <li class="level2"><a href="#sigma-algebra-regions">Sigma Algebra Regions</a></li>
          <li class="level2"><a href="#kolmogorov-for-querying-probability-models">Kolmogorov for querying Probability Models</a></li>
          <li class="level2"><a href="#bayes-theorem-conditioning-and-filtering">Bayes Theorem, Conditioning, and Filtering</a></li>
          <li class="level2"><a href="#probability-model-as-monads">Probability Model as Monads</a></li>
          <li class="level2"><a href="#summing-two-dice-rolls">Summing two dice rolls</a></li>
          <li class="level2"><a href="#future-work">Future work</a></li>
          <li class="level1"><a href="#statistics">Statistics</a></li>
          <li class="level2"><a href="#uniform-distribution">Uniform Distribution</a></li>
          <li class="level2"><a href="#standard-deviation">Standard Deviation</a></li>
          <li class="level1"><a href="#root-mean-square-deviation">Root-mean-square deviation</a></li>
          <li class="level1"><a href="#reservoir-sampling">Reservoir Sampling</a></li>
          <li class="level1"><a href="#information-theory">Information Theory</a></li>
          <li class="level2"><a href="#entropy">Entropy</a></li>
          <li class="level2"><a href="#example-entropy-of-a-biased-coin">Example: Entropy of a Biased Coin</a></li>
          <li class="level1"><a href="#probabilistic-graphical-models">Probabilistic Graphical Models</a></li>
          <li class="level2"><a href="#bayesian-networks">Bayesian Networks</a></li>
          <li class="level2"><a href="#example-alarm">Example: Alarm</a></li>
          <li class="level1"><a href="#probability-model-future-work">Probability Model Future Work</a></li>
          <li class="level2"><a href="#later">Later</a></li>
          <li class="level2"><a href="#docs">Docs</a></li>
        </ul>
        
        <p class="footer"></p>
      </nav>

      <main class="content">

        <h1 id="randomness-and-uncertainty" class="title">Randomness and Uncertainty</h1>
        
        <h2 id="probability-model" class="section"><a class="anchor-link left" href="#probability-model"><i class="icofont-laika">&#xef71;</i></a>Probability Model</h2>
        <p>Modeling probability, randomness, and uncertainly is one of the primary objectives of Axle.</p>
        <p>The capabilies are available via four typeclasses and one trait</p>
        <ul>
          <li>Sampler</li>
          <li>Region (trait modeling Ïƒ-algebra)</li>
          <li>Kolmogorov</li>
          <li>Bayes</li>
          <li>Monad (<code>cats.Monad</code>)</li>
        </ul>
        <p>Concrete number type are avoided in favor of structures from Abstract Algebra --
        primarily <code>Ring</code> and <code>Field</code>.
        These are represented as context bounds, usually passed implicitly.</p>
        <p>The examples in this document use the <code>spire.math.Rational</code> number type, but work as well
        for <code>Double</code>, <code>Float</code>, etc.
        The precise number type <code>Rational</code> is used in tests because their precision allows the assertions to be expressed without any error tolerance.</p>
        
        <h3 id="imports" class="section"><a class="anchor-link left" href="#imports"><i class="icofont-laika">&#xef71;</i></a>Imports</h3>
        <p>Preamble to pull in the commonly-used functions in this section:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">math</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">probability</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">visualize</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">web</span><span>.</span><span class="identifier">_</span></code></pre>
        
        <h3 id="creating-probability-models" class="section"><a class="anchor-link left" href="#creating-probability-models"><i class="icofont-laika">&#xef71;</i></a>Creating Probability Models</h3>
        <p>There are a few type of probability models in Axle.
        The simplest is the <code>ConditionalProbabilityTable</code>, which is used throughout this document.</p>
        <p><code>axle.data.Coin.flipModel</code> demonstrates a very simple probability model for type <code>Symbol</code>.</p>
        <p>This is its implementation:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">head</span><span> = </span><span class="type-name">Symbol</span><span>(</span><span class="string-literal">&quot;HEAD&quot;</span><span>)
</span><span class="keyword">val</span><span> </span><span class="identifier">tail</span><span> = </span><span class="type-name">Symbol</span><span>(</span><span class="string-literal">&quot;TAIL&quot;</span><span>)

</span><span class="keyword">def</span><span> </span><span class="declaration-name">flipModel</span><span>(</span><span class="identifier">pHead</span><span>: </span><span class="type-name">Rational</span><span> = </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">2</span><span>)): </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Rational</span><span>] =
  </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Rational</span><span>](
    </span><span class="type-name">Map</span><span>(
      </span><span class="identifier">head</span><span> -&gt; </span><span class="identifier">pHead</span><span>,
      </span><span class="identifier">tail</span><span> -&gt; (</span><span class="number-literal">1</span><span> - </span><span class="identifier">pHead</span><span>)))</span></code></pre>
        <p>Its argument is the bias for the <code>HEAD</code> side.
        Without a provided bias, it is assumed to be a fair coin.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">fairCoin</span><span> = </span><span class="identifier">flipModel</span><span>()
</span><span class="comment">// fairCoin: ConditionalProbabilityTable[Symbol, Rational] = ConditionalProbabilityTable(
//   p = Map(&#39;HEAD -&gt; 1/2, &#39;TAIL -&gt; 1/2)
// )
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">biasedCoin</span><span> = </span><span class="identifier">flipModel</span><span>(</span><span class="type-name">Rational</span><span>(</span><span class="number-literal">9</span><span>, </span><span class="number-literal">10</span><span>))
</span><span class="comment">// biasedCoin: ConditionalProbabilityTable[Symbol, Rational] = ConditionalProbabilityTable(
//   p = Map(&#39;HEAD -&gt; 9/10, &#39;TAIL -&gt; 1/10)
// )</span></code></pre>
        <p>Rolls of dice are another common example.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">rollModel</span><span>(</span><span class="identifier">n</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>] =
  </span><span class="type-name">ConditionalProbabilityTable</span><span>(
    (</span><span class="number-literal">1</span><span> </span><span class="identifier">to</span><span> </span><span class="identifier">n</span><span>).</span><span class="identifier">map</span><span>(</span><span class="identifier">i</span><span> =&gt; (</span><span class="identifier">i</span><span>, </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="identifier">n</span><span>.</span><span class="identifier">toLong</span><span>))).</span><span class="identifier">toMap</span><span>)</span></code></pre>
        <p>The values <code>d6</code> and <code>d10</code> model rolls of 6 and 10-sided dice.</p>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">d6</span><span> = </span><span class="identifier">rollModel</span><span>(</span><span class="number-literal">6</span><span>)
</span><span class="comment">// d6: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = HashMap(5 -&gt; 1/6, 1 -&gt; 1/6, 6 -&gt; 1/6, 2 -&gt; 1/6, 3 -&gt; 1/6, 4 -&gt; 1/6)
// )
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">d10</span><span> = </span><span class="identifier">rollModel</span><span>(</span><span class="number-literal">10</span><span>)
</span><span class="comment">// d10: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = HashMap(
//     5 -&gt; 1/10,
//     10 -&gt; 1/10,
//     1 -&gt; 1/10,
//     6 -&gt; 1/10,
//     9 -&gt; 1/10,
//     2 -&gt; 1/10,
//     7 -&gt; 1/10,
//     3 -&gt; 1/10,
//     8 -&gt; 1/10,
//     4 -&gt; 1/10
//   )
// )</span></code></pre>
        <p>Define a visualization of the distribution of events in the <code>d6</code> model:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">d6vis</span><span> = </span><span class="type-name">BarChart</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>], </span><span class="type-name">String</span><span>](
  () =&gt; </span><span class="identifier">d6</span><span>,
  </span><span class="identifier">colorOf</span><span> = </span><span class="identifier">_</span><span> =&gt; </span><span class="type-name">Color</span><span>.</span><span class="identifier">blue</span><span>,
  </span><span class="identifier">xAxis</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="type-name">Rational</span><span>(</span><span class="number-literal">0</span><span>)),
  </span><span class="identifier">title</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;d6&quot;</span><span>),
  </span><span class="identifier">labelAngle</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="number-literal">0d</span><span> *: </span><span class="identifier">angleDouble</span><span>.</span><span class="identifier">degree</span><span>),
  </span><span class="identifier">drawKey</span><span> = </span><span class="boolean-literal">false</span><span>)</span></code></pre>
        <p>Create an SVG</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">d6vis</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/d6.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p><img src="/images/d6.svg" alt="d6"></p>
        
        <h3 id="sampler" class="section"><a class="anchor-link left" href="#sampler"><i class="icofont-laika">&#xef71;</i></a>Sampler</h3>
        <p>The <code>Sampler</code> typeclass provides the ability to &quot;execute&quot; the model and product
        a random sample via the <code>sample</code> method.</p>
        <p>It&#39;s type signature is:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">sample</span><span>(</span><span class="identifier">gen</span><span>: </span><span class="type-name">Generator</span><span>)(</span><span class="keyword">implicit</span><span> </span><span class="identifier">spireDist</span><span>: </span><span class="type-name">Dist</span><span>[</span><span class="type-name">V</span><span>], </span><span class="identifier">ringV</span><span>: </span><span class="type-name">Ring</span><span>[</span><span class="type-name">V</span><span>], </span><span class="identifier">orderV</span><span>: </span><span class="type-name">Order</span><span>[</span><span class="type-name">V</span><span>]): </span><span class="type-name">A</span></code></pre>
        <p>These imports make available a <code>Generator</code> as source of entropy</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">random</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">rng</span><span> = </span><span class="type-name">Random</span><span>.</span><span class="identifier">generatorFromSeed</span><span>(</span><span class="type-name">Seed</span><span>(</span><span class="number-literal">42</span><span>))
</span><span class="comment">// rng: spire.random.rng.Cmwc5 = spire.random.rng.Cmwc5@7c47a58f</span></code></pre>
        <p>And then the <code>.sample</code> syntax:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">sampler</span><span>.</span><span class="identifier">_</span></code></pre>
        <p><code>sample</code> requires a Spire <code>Generator</code>.
        It also requires context bounds on the value type <code>V</code> that give the method
        the ability to produces values with a distribution conforming to the probability model.</p>
        <pre><code class="nohighlight"><span>(</span><span class="number-literal">1</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">10</span><span>) </span><span class="identifier">map</span><span> { </span><span class="identifier">_</span><span> =&gt; </span><span class="identifier">fairCoin</span><span>.</span><span class="identifier">sample</span><span>(</span><span class="identifier">rng</span><span>) }
</span><span class="comment">// res1: IndexedSeq[Symbol] = Vector(
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;TAIL,
//   &#39;TAIL,
//   &#39;HEAD,
//   &#39;TAIL,
//   &#39;TAIL,
//   &#39;TAIL,
//   &#39;HEAD
// )</span></code></pre>
        <pre><code class="nohighlight"><span>(</span><span class="number-literal">1</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">10</span><span>) </span><span class="identifier">map</span><span> { </span><span class="identifier">_</span><span> =&gt; </span><span class="identifier">biasedCoin</span><span>.</span><span class="identifier">sample</span><span>(</span><span class="identifier">rng</span><span>) }
</span><span class="comment">// res2: IndexedSeq[Symbol] = Vector(
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD,
//   &#39;HEAD
// )</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span>(</span><span class="number-literal">1</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">10</span><span>) </span><span class="identifier">map</span><span> { </span><span class="identifier">_</span><span> =&gt; </span><span class="identifier">d6</span><span>.</span><span class="identifier">sample</span><span>(</span><span class="identifier">rng</span><span>) }
</span><span class="comment">// res3: IndexedSeq[Int] = Vector(3, 2, 5, 2, 6, 2, 6, 1, 1, 5)</span></code></pre>
        <p>Simulate 1k rolls of one d6</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">rolls</span><span> = (</span><span class="number-literal">0</span><span> </span><span class="identifier">until</span><span> </span><span class="number-literal">1000</span><span>) </span><span class="identifier">map</span><span> { </span><span class="identifier">_</span><span> =&gt; </span><span class="identifier">d6</span><span>.</span><span class="identifier">sample</span><span>(</span><span class="identifier">rng</span><span>) }</span></code></pre>
        <p>Then tally them</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">ringInt</span><span>: </span><span class="type-name">CRing</span><span>[</span><span class="type-name">Int</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">IntAlgebra</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">talliable</span><span>.</span><span class="identifier">_</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">oneKd6Histogram</span><span> = </span><span class="identifier">rolls</span><span>.</span><span class="identifier">tally</span><span>
</span><span class="comment">// oneKd6Histogram: Map[Int, Int] = Map(
//   5 -&gt; 167,
//   1 -&gt; 160,
//   6 -&gt; 176,
//   2 -&gt; 171,
//   3 -&gt; 164,
//   4 -&gt; 162
// )</span></code></pre>
        <p>Create a visualization</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">d6oneKvis</span><span> = </span><span class="type-name">BarChart</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Int</span><span>, </span><span class="type-name">Map</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Int</span><span>], </span><span class="type-name">String</span><span>](
  () =&gt; </span><span class="identifier">oneKd6Histogram</span><span>,
  </span><span class="identifier">colorOf</span><span> = </span><span class="identifier">_</span><span> =&gt; </span><span class="type-name">Color</span><span>.</span><span class="identifier">blue</span><span>,
  </span><span class="identifier">xAxis</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="number-literal">0</span><span>),
  </span><span class="identifier">title</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;1,000 d6 samples&quot;</span><span>),
  </span><span class="identifier">labelAngle</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="number-literal">0d</span><span> *: </span><span class="identifier">angleDouble</span><span>.</span><span class="identifier">degree</span><span>),
  </span><span class="identifier">drawKey</span><span> = </span><span class="boolean-literal">false</span><span>)</span></code></pre>
        <p>Create the SVG</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">d6oneKvis</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/d6-1Ksamples.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p><img src="/images/d6-1Ksamples.svg" alt="1k d6 samples"></p>
        
        <h3 id="sigma-algebra-regions" class="section"><a class="anchor-link left" href="#sigma-algebra-regions"><i class="icofont-laika">&#xef71;</i></a>Sigma Algebra Regions</h3>
        <p>The sealed <code>Region[A]</code> trait is extended by the following case classes
        that form a way to describe expressions on the event-space of a probability model.
        In Measure Theory, these expressions are said to form a &quot;sigma-algebra&quot; (&quot;Ïƒ-algebra&quot;)</p>
        <p>In order of arity, they case classes extending this trait are:</p>
        
        <h4 id="arity-0" class="section"><a class="anchor-link left" href="#arity-0"><i class="icofont-laika">&#xef71;</i></a>Arity 0</h4>
        <ul>
          <li><code>RegionEmpty</code> never matches any events or probability mass</li>
          <li><code>RegionAll</code> always matches all events and probability mass</li>
        </ul>
        
        <h4 id="arity-1-not-including-typeclass-witnesses" class="section"><a class="anchor-link left" href="#arity-1-not-including-typeclass-witnesses"><i class="icofont-laika">&#xef71;</i></a>Arity 1 (not including typeclass witnesses)</h4>
        <ul>
          <li><code>RegionEq</code> matches when an event is equal to the supplied object, with respect to the supplied <code>cats.kernel.Eq[A]</code> witness.</li>
          <li><code>RegionIf</code> matches when the supplied condition function returns <code>true</code></li>
          <li><code>RegionSet</code> matches when an event is contained within the supplied <code>Set[A]</code>.</li>
          <li><code>RegionNegate</code> negates the supplied region.</li>
          <li><code>RegionGTE</code> is true when an event is greater than or equal to the supplied object, with respect to the supplied <code>cats.kernel.Order[A]</code></li>
          <li><code>RegionLTE</code> is true when an event is less than or equal to the supplied object, with respect to the supplied <code>cats.kernel.Order[A]</code></li>
        </ul>
        
        <h4 id="arity-2" class="section"><a class="anchor-link left" href="#arity-2"><i class="icofont-laika">&#xef71;</i></a>Arity 2</h4>
        <ul>
          <li><code>RegionAnd</code> is the conjunction of both arguments.  It can be created using the <code>and</code> method in the <code>Region</code> trait.</li>
          <li><code>RegionOr</code> is the disjunction of both arguments.  It can be created using the <code>or</code> method in the <code>Region</code> trait.</li>
        </ul>
        <p>Note that a &quot;Random Variable&quot; does not appear in this discussion.
        The <code>axle.probability.Variable</code> class does define a <code>is</code> method that returns a <code>RegionEq</code>,
        but the probability models themselves are not concerned with the notion of a
        <code>Variable</code>.
        They are simply models over regions of events on their single, opaque type
        that adhere to the laws of probability.</p>
        <p>The eventual formalization of <code>Region</code> should connect it with a Ïƒ-algebra from Meaasure Theory.</p>
        
        <h3 id="kolmogorov-for-querying-probability-models" class="section"><a class="anchor-link left" href="#kolmogorov-for-querying-probability-models"><i class="icofont-laika">&#xef71;</i></a>Kolmogorov for querying Probability Models</h3>
        
        <h4 id="probabilityof-aka-p" class="section"><a class="anchor-link left" href="#probabilityof-aka-p"><i class="icofont-laika">&#xef71;</i></a>probabilityOf (aka &quot;P&quot;)</h4>
        <p>The method <code>probabilityOf</code> is defined in terms of a <code>Region</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">probabilityOf</span><span>(</span><span class="identifier">predicate</span><span>: </span><span class="type-name">Region</span><span>[</span><span class="type-name">A</span><span>])(</span><span class="keyword">implicit</span><span> </span><span class="identifier">fieldV</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">V</span><span>]): </span><span class="type-name">V</span></code></pre>
        <p>Note that <code>probabilityOf</code> is aliased to <code>P</code> in <code>axle.syntax.kolmogorov._</code></p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">kolmogorov</span><span>.</span><span class="identifier">_</span></code></pre>
        <p>The probability of a <code>head</code> for a single toss of a fair coin is <code>1/2</code></p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">fairCoin</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">head</span><span>))
</span><span class="comment">// res5: Rational = 1/2</span></code></pre>
        <p>The probability that a toss is not <code>head</code> is also <code>1/2</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">fairCoin</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionNegate</span><span>(</span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">head</span><span>)))
</span><span class="comment">// res6: Rational = 1/2</span></code></pre>
        <p>The probability that a toss is both <code>head</code> and <code>tail</code> is zero.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">fairCoin</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">head</span><span>) </span><span class="identifier">and</span><span> </span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">tail</span><span>))
</span><span class="comment">// res7: Rational = 0</span></code></pre>
        <p>The probability that a toss is either <code>head</code> or <code>tail</code> is one.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">fairCoin</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">head</span><span>) </span><span class="identifier">or</span><span> </span><span class="type-name">RegionEq</span><span>(</span><span class="identifier">tail</span><span>))
</span><span class="comment">// res8: Rational = 1</span></code></pre>
        
        <h4 id="kolmogorov-s-axioms" class="section"><a class="anchor-link left" href="#kolmogorov-s-axioms"><i class="icofont-laika">&#xef71;</i></a>Kolmogorov&#39;s Axioms</h4>
        <p>The single <code>probabilityOf</code> method together with the <code>Region</code> trait
        is enough to define Kolmogorov&#39;s Axioms of Probability.
        The axioms are implemented in <code>axle.laws.KolmogorovProbabilityAxioms</code> and
        checked during testing with ScalaCheck.</p>
        
        <h5 id="basic-measure" class="section"><a class="anchor-link left" href="#basic-measure"><i class="icofont-laika">&#xef71;</i></a>Basic Measure</h5>
        <p>Probabilities are non-negative.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">region</span><span>) &gt;= </span><span class="type-name">Field</span><span>[</span><span class="type-name">V</span><span>].</span><span class="identifier">zero</span></code></pre>
        
        <h5 id="unit-measure" class="section"><a class="anchor-link left" href="#unit-measure"><i class="icofont-laika">&#xef71;</i></a>Unit Measure</h5>
        <p>The sum the probabilities of all possible events is <code>one</code></p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionAll</span><span>()) === </span><span class="type-name">Field</span><span>[</span><span class="type-name">V</span><span>].</span><span class="identifier">one</span></code></pre>
        
        <h5 id="combination" class="section"><a class="anchor-link left" href="#combination"><i class="icofont-laika">&#xef71;</i></a>Combination</h5>
        <p>For disjoint event regions, <code>e1</code> and <code>e2</code>, the probability of their disjunction <code>e1 or e2</code>
        is equal to the sum of their independent probabilities.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span>(!((</span><span class="identifier">e1</span><span> </span><span class="identifier">and</span><span> </span><span class="identifier">e2</span><span>) === </span><span class="type-name">RegionEmpty</span><span>() )) || (</span><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">e1</span><span> </span><span class="identifier">or</span><span> </span><span class="identifier">e2</span><span>) === </span><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">e1</span><span>) + </span><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">e2</span><span>))</span></code></pre>
        
        <h3 id="bayes-theorem-conditioning-and-filtering" class="section"><a class="anchor-link left" href="#bayes-theorem-conditioning-and-filtering"><i class="icofont-laika">&#xef71;</i></a>Bayes Theorem, Conditioning, and Filtering</h3>
        <p>The <code>Bayes</code> typeclass implements the conditioning of a probability model
        via the <code>filter</code> (<code>|</code> is also an alias).</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">filter</span><span>(</span><span class="identifier">predicate</span><span>: </span><span class="type-name">Region</span><span>[</span><span class="type-name">A</span><span>])(</span><span class="keyword">implicit</span><span> </span><span class="identifier">fieldV</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">V</span><span>]): </span><span class="type-name">M</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">V</span><span>]</span></code></pre>
        <p>Syntax is available via this import</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">bayes</span><span>.</span><span class="identifier">_</span></code></pre>
        <p><code>filter</code> -- along with <code>probabilityOf</code> from <code>Kolomogorov</code> -- allows Bayes&#39; Theorem
        to be expressed and checked with ScalaCheck.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">model</span><span>.</span><span class="identifier">filter</span><span>(</span><span class="identifier">b</span><span>).</span><span class="type-name">P</span><span>(</span><span class="identifier">a</span><span>) * </span><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">b</span><span>) === </span><span class="identifier">model</span><span>.</span><span class="identifier">filter</span><span>(</span><span class="identifier">a</span><span>).</span><span class="type-name">P</span><span>(</span><span class="identifier">b</span><span>) * </span><span class="identifier">model</span><span>.</span><span class="type-name">P</span><span>(</span><span class="identifier">a</span><span>)</span></code></pre>
        <p>For non-zero <code>model.P(a)</code> and <code>model.P(b)</code></p>
        <p>The theorem is more recognizable as <code>P(A|B) = P(B|A) * P(A) / P(B)</code></p>
        <p>Filter is easier to motivate with composite types, but two examples
        with a d6 show the expected semantics:</p>
        <p>Filtering the d6 roll model to 1 and 5:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">d6</span><span>.</span><span class="identifier">filter</span><span>(</span><span class="type-name">RegionIf</span><span>(</span><span class="identifier">_</span><span> % </span><span class="number-literal">4</span><span> == </span><span class="number-literal">1</span><span>))
</span><span class="comment">// res9: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = Map(5 -&gt; 1/2, 1 -&gt; 1/2)
// )</span></code></pre>
        <p>Filter the d6 roll model to 1, 2, and 3:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">d6</span><span>.</span><span class="identifier">filter</span><span>(</span><span class="type-name">RegionLTE</span><span>(</span><span class="number-literal">3</span><span>))
</span><span class="comment">// res10: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = Map(1 -&gt; 1/3, 2 -&gt; 1/3, 3 -&gt; 1/3)
// )</span></code></pre>
        
        <h3 id="probability-model-as-monads" class="section"><a class="anchor-link left" href="#probability-model-as-monads"><i class="icofont-laika">&#xef71;</i></a>Probability Model as Monads</h3>
        <p>The <code>pure</code>, <code>map</code>, and <code>flatMap</code> methods of <code>cats.Monad</code> are defined
        for <code>ConditionalProbabilityTable</code>, <code>TallyDistribution</code>.</p>
        
        <h4 id="monad-laws" class="section"><a class="anchor-link left" href="#monad-laws"><i class="icofont-laika">&#xef71;</i></a>Monad Laws</h4>
        <p>The short version is that the three methods are constrained by a few laws that
        make them very useful for composing programs.
        Those laws are:</p>
        <ul>
          <li>Left identity: <code>pure(x).flatMap(f) === f(x)</code></li>
          <li>Right identity: <code>model.flatMap(pure) === model</code></li>
          <li>Associativity: <code>model.flatMap(f).flatMap(g) === model.flatMap(f.flatMap(g))</code></li>
        </ul>
        
        <h4 id="monad-syntax" class="section"><a class="anchor-link left" href="#monad-syntax"><i class="icofont-laika">&#xef71;</i></a>Monad Syntax</h4>
        <p>There is syntax support in <code>cats.implicits._</code> for all three methods.</p>
        <p>However, due to limitations of Scala&#39;s type inference, it cannot see
        <code>ConditionalProbabilityTable[E, V]</code> as the <code>M[_]</code> expected by <code>Monad</code>.</p>
        <p>The most straigtfoward workaround is just to conjure the monad witness
        directly and use it, passing the model in as the sole argument to the
        first parameter group.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">monad</span><span> = </span><span class="type-name">ConditionalProbabilityTable</span><span>.</span><span class="identifier">monadWitness</span><span>[</span><span class="type-name">Rational</span><span>]</span></code></pre>
        <pre><code class="nohighlight"><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">a</span><span> =&gt; </span><span class="identifier">monad</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">b</span><span> =&gt; </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span><span> } }
</span><span class="comment">// res11: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = HashMap(
//     5 -&gt; 1/9,
//     10 -&gt; 1/12,
//     6 -&gt; 5/36,
//     9 -&gt; 1/9,
//     2 -&gt; 1/36,
//     12 -&gt; 1/36,
//     7 -&gt; 1/6,
//     3 -&gt; 1/18,
//     11 -&gt; 1/18,
//     8 -&gt; 5/36,
//     4 -&gt; 1/12
//   )
// )</span></code></pre>
        <p>Another strategy to use <code>map</code> and <code>flatMap</code> directly on
        the model is a type that can be seen as <code>M[_]</code> along with
        a type annotation:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">type</span><span> </span><span class="type-name">CPTR</span><span>[</span><span class="type-name">E</span><span>] = </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">E</span><span>, </span><span class="type-name">Rational</span><span>]

(</span><span class="identifier">d6</span><span>: </span><span class="type-name">CPTR</span><span>[</span><span class="type-name">Int</span><span>]).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">a</span><span> =&gt; (</span><span class="identifier">d6</span><span>: </span><span class="type-name">CPTR</span><span>[</span><span class="type-name">Int</span><span>]).</span><span class="identifier">map</span><span> { </span><span class="identifier">b</span><span> =&gt; </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span><span> } }</span></code></pre>
        <p>Or similar to use a for comprehension:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">for</span><span> {
  </span><span class="identifier">a</span><span> &lt;- </span><span class="identifier">d6</span><span>: </span><span class="type-name">CPTR</span><span>[</span><span class="type-name">Int</span><span>]
  </span><span class="identifier">b</span><span> &lt;- </span><span class="identifier">d6</span><span>: </span><span class="type-name">CPTR</span><span>[</span><span class="type-name">Int</span><span>]
} </span><span class="keyword">yield</span><span> </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span></code></pre>
        
        <h4 id="chaining-models" class="section"><a class="anchor-link left" href="#chaining-models"><i class="icofont-laika">&#xef71;</i></a>Chaining models</h4>
        <p>Chain two events&#39; models</p>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">bothCoinsModel</span><span> = </span><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">fairCoin</span><span>) { </span><span class="identifier">flip1</span><span> =&gt;
  </span><span class="identifier">monad</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">fairCoin</span><span>) { </span><span class="identifier">flip2</span><span> =&gt;
    (</span><span class="identifier">flip1</span><span>, </span><span class="identifier">flip2</span><span>)
  }
}
</span><span class="comment">// bothCoinsModel: ConditionalProbabilityTable[(Symbol, Symbol), Rational] = ConditionalProbabilityTable(
//   p = HashMap(
//     (&#39;HEAD, &#39;HEAD) -&gt; 1/4,
//     (&#39;TAIL, &#39;HEAD) -&gt; 1/4,
//     (&#39;TAIL, &#39;TAIL) -&gt; 1/4,
//     (&#39;HEAD, &#39;TAIL) -&gt; 1/4
//   )
// )</span></code></pre>
        <p>This creates a model on events of type <code>(Symbol, Symbol)</code></p>
        <p>It can be queried with <code>P</code> using <code>RegionIf</code> to check fields within the <code>Tuple2</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">type</span><span> </span><span class="type-name">TWOFLIPS</span><span> = (</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Symbol</span><span>)

</span><span class="identifier">bothCoinsModel</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionIf</span><span>[</span><span class="type-name">TWOFLIPS</span><span>](</span><span class="identifier">_</span><span class="number-literal">._1</span><span> == </span><span class="identifier">head</span><span>) </span><span class="identifier">and</span><span> </span><span class="type-name">RegionIf</span><span>[</span><span class="type-name">TWOFLIPS</span><span>](</span><span class="identifier">_</span><span class="number-literal">._2</span><span> == </span><span class="identifier">head</span><span>))
</span><span class="comment">// res14: Rational = 1/4
</span><span>
</span><span class="identifier">bothCoinsModel</span><span>.</span><span class="type-name">P</span><span>(</span><span class="type-name">RegionIf</span><span>[</span><span class="type-name">TWOFLIPS</span><span>](</span><span class="identifier">_</span><span class="number-literal">._1</span><span> == </span><span class="identifier">head</span><span>) </span><span class="identifier">or</span><span> </span><span class="type-name">RegionIf</span><span>[</span><span class="type-name">TWOFLIPS</span><span>](</span><span class="identifier">_</span><span class="number-literal">._2</span><span> == </span><span class="identifier">head</span><span>))
</span><span class="comment">// res15: Rational = 3/4</span></code></pre>
        
        <h3 id="summing-two-dice-rolls" class="section"><a class="anchor-link left" href="#summing-two-dice-rolls"><i class="icofont-laika">&#xef71;</i></a>Summing two dice rolls</h3>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">twoDiceSummed</span><span> = </span><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">a</span><span> =&gt;
  </span><span class="identifier">monad</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">b</span><span> =&gt;
    </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span><span>
  }
}
</span><span class="comment">// twoDiceSummed: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = HashMap(
//     5 -&gt; 1/9,
//     10 -&gt; 1/12,
//     6 -&gt; 5/36,
//     9 -&gt; 1/9,
//     2 -&gt; 1/36,
//     12 -&gt; 1/36,
//     7 -&gt; 1/6,
//     3 -&gt; 1/18,
//     11 -&gt; 1/18,
//     8 -&gt; 5/36,
//     4 -&gt; 1/12
//   )
// )</span></code></pre>
        <p>Create a visualization</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">monadicChart</span><span> = </span><span class="type-name">BarChart</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>], </span><span class="type-name">String</span><span>](
  () =&gt; </span><span class="identifier">twoDiceSummed</span><span>,
  </span><span class="identifier">colorOf</span><span> = </span><span class="identifier">_</span><span> =&gt; </span><span class="type-name">Color</span><span>.</span><span class="identifier">blue</span><span>,
  </span><span class="identifier">xAxis</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="type-name">Rational</span><span>(</span><span class="number-literal">0</span><span>)),
  </span><span class="identifier">title</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;d6 + d6&quot;</span><span>),
  </span><span class="identifier">labelAngle</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="number-literal">0d</span><span> *: </span><span class="identifier">angleDouble</span><span>.</span><span class="identifier">degree</span><span>),
  </span><span class="identifier">drawKey</span><span> = </span><span class="boolean-literal">false</span><span>)</span></code></pre>
        <p>Create SVG</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">monadicChart</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/distributionMonad.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p><img src="/images/distributionMonad.svg" alt="Monadic d6 + d6"></p>
        
        <h4 id="iffy" class="section"><a class="anchor-link left" href="#iffy"><i class="icofont-laika">&#xef71;</i></a>Iffy</h4>
        <p>A stochastic version of <code>if</code> (aka <code>iffy</code>) can be implemented in terms of <code>flatMap</code>
        using this pattern for any probability model type <code>M[A]</code> such that a <code>Monad</code> is defined.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">iffy</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">B</span><span>, </span><span class="type-name">M</span><span>[</span><span class="identifier">_</span><span>]: </span><span class="type-name">Monad</span><span>](
  </span><span class="identifier">input</span><span>      : </span><span class="type-name">M</span><span>[</span><span class="type-name">A</span><span>],
  </span><span class="identifier">predicate</span><span>  : </span><span class="type-name">A</span><span> =&gt; </span><span class="type-name">Boolean</span><span>,
  </span><span class="identifier">trueClause</span><span> : </span><span class="type-name">M</span><span>[</span><span class="type-name">B</span><span>],
  </span><span class="identifier">falseClause</span><span>: </span><span class="type-name">M</span><span>[</span><span class="type-name">B</span><span>]): </span><span class="type-name">M</span><span>[</span><span class="type-name">B</span><span>] =
  </span><span class="identifier">input</span><span>.</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">i</span><span> =&gt;
    </span><span class="keyword">if</span><span>( </span><span class="identifier">predicate</span><span>(</span><span class="identifier">i</span><span>) ) {
      </span><span class="identifier">trueClause</span><span>
    } </span><span class="keyword">else</span><span> {
      </span><span class="identifier">falseClause</span><span>
    }
  }</span></code></pre>
        <p>An example of that pattern: &quot;if heads, d6+d6, otherwise d10+d10&quot;</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="type-name">Eq</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">headsD6D6taildD10D10</span><span> = </span><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">fairCoin</span><span>) { </span><span class="identifier">side</span><span> =&gt;
  </span><span class="keyword">if</span><span>( </span><span class="type-name">Eq</span><span>[</span><span class="type-name">Symbol</span><span>].</span><span class="identifier">eqv</span><span>(</span><span class="identifier">side</span><span>, </span><span class="identifier">head</span><span>) ) {
    </span><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">a</span><span> =&gt; </span><span class="identifier">monad</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">d6</span><span>) { </span><span class="identifier">b</span><span> =&gt; </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span><span> } }
  } </span><span class="keyword">else</span><span> {
    </span><span class="identifier">monad</span><span>.</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">d10</span><span>) { </span><span class="identifier">a</span><span> =&gt; </span><span class="identifier">monad</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">d10</span><span>) { </span><span class="identifier">b</span><span> =&gt; </span><span class="identifier">a</span><span> + </span><span class="identifier">b</span><span> } }
  }
}</span></code></pre>
        <p>Create visualization</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">iffyChart</span><span> = </span><span class="type-name">BarChart</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">ConditionalProbabilityTable</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>], </span><span class="type-name">String</span><span>](
  () =&gt; </span><span class="identifier">headsD6D6taildD10D10</span><span>,
  </span><span class="identifier">colorOf</span><span> = </span><span class="identifier">_</span><span> =&gt; </span><span class="type-name">Color</span><span>.</span><span class="identifier">blue</span><span>,
  </span><span class="identifier">xAxis</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="type-name">Rational</span><span>(</span><span class="number-literal">0</span><span>)),
  </span><span class="identifier">title</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;if heads, d6+d6, else d10+d10&quot;</span><span>),
  </span><span class="identifier">labelAngle</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="number-literal">0d</span><span> *: </span><span class="identifier">angleDouble</span><span>.</span><span class="identifier">degree</span><span>),
  </span><span class="identifier">drawKey</span><span> = </span><span class="boolean-literal">false</span><span>)</span></code></pre>
        <p>Create the SVG</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">iffyChart</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/iffy.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p><img src="/images/iffy.svg" alt="heads => d6+d6, else d10+d10"></p>
        
        <h4 id="further-reading" class="section"><a class="anchor-link left" href="#further-reading"><i class="icofont-laika">&#xef71;</i></a>Further Reading</h4>
        <p>Motiviating the Monad typeclass is out of scope of this document.
        Please see the functional programming literature for more about monads
        and their relationship to functors, applicative functors, monoids, categories,
        and other structures.</p>
        <p>For some historical reading on the origins of probability monads,
        see the literature on the Giry Monad.</p>
        
        <h3 id="future-work" class="section"><a class="anchor-link left" href="#future-work"><i class="icofont-laika">&#xef71;</i></a>Future work</h3>
        
        <h4 id="measure-theory" class="section"><a class="anchor-link left" href="#measure-theory"><i class="icofont-laika">&#xef71;</i></a>Measure Theory</h4>
        <p>Further refining and extending Axle to incorporate Measure Theory is a likely follow-on step.</p>
        
        <h4 id="markov-categories" class="section"><a class="anchor-link left" href="#markov-categories"><i class="icofont-laika">&#xef71;</i></a>Markov Categories</h4>
        <p>As an alternative to Measure Theory, see Tobias Fritz&#39;s work on Markov Categories</p>
        
        <h4 id="probabilistic-and-differentiable-programming" class="section"><a class="anchor-link left" href="#probabilistic-and-differentiable-programming"><i class="icofont-laika">&#xef71;</i></a>Probabilistic and Differentiable Programming</h4>
        <p>In general, the explosion of work on probabilistic and differentible programming is fertile ground for Axle&#39;s lawful approach.</p>
        
        <h2 id="statistics" class="section"><a class="anchor-link left" href="#statistics"><i class="icofont-laika">&#xef71;</i></a>Statistics</h2>
        <p>Common imports and implicits</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">probability</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span></code></pre>
        
        <h3 id="uniform-distribution" class="section"><a class="anchor-link left" href="#uniform-distribution"><i class="icofont-laika">&#xef71;</i></a>Uniform Distribution</h3>
        <p>Example</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="type-name">X</span><span> = </span><span class="identifier">uniformDistribution</span><span>(</span><span class="type-name">List</span><span>(</span><span class="number-literal">2d</span><span>, </span><span class="number-literal">4d</span><span>, </span><span class="number-literal">4d</span><span>, </span><span class="number-literal">4d</span><span>, </span><span class="number-literal">5d</span><span>, </span><span class="number-literal">5d</span><span>, </span><span class="number-literal">7d</span><span>, </span><span class="number-literal">9d</span><span>))
</span><span class="comment">// X: ConditionalProbabilityTable[Double, spire.math.Rational] = ConditionalProbabilityTable(
//   p = HashMap(5.0 -&gt; 1/4, 9.0 -&gt; 1/8, 2.0 -&gt; 1/8, 7.0 -&gt; 1/8, 4.0 -&gt; 3/8)
// )</span></code></pre>
        
        <h3 id="standard-deviation" class="section"><a class="anchor-link left" href="#standard-deviation"><i class="icofont-laika">&#xef71;</i></a>Standard Deviation</h3>
        <p>Example</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">stats</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">nrootDouble</span><span>: </span><span class="type-name">NRoot</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">standardDeviation</span><span>(</span><span class="type-name">X</span><span>)
</span><span class="comment">// res19: Double = 2.0</span></code></pre>
        <p>See also <a href="#probability-model">Probability Model</a></p>
        
        <h2 id="root-mean-square-deviation" class="section"><a class="anchor-link left" href="#root-mean-square-deviation"><i class="icofont-laika">&#xef71;</i></a>Root-mean-square deviation</h2>
        <p>See the Wikipedia page on
        <a href="https://en.wikipedia.org/wiki/Root-mean-square_deviation">Root-mean-square deviation</a>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="type-name">Field</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="type-name">NRoot</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">stats</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span><span>
</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">nrootDouble</span><span>: </span><span class="type-name">NRoot</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span></code></pre>
        <p>Given four numbers and an estimator function, compute the RMSD:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">data</span><span> = </span><span class="type-name">List</span><span>(</span><span class="number-literal">1d</span><span>, </span><span class="number-literal">2d</span><span>, </span><span class="number-literal">3d</span><span>, </span><span class="number-literal">4d</span><span>)</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">estimator</span><span>(</span><span class="identifier">x</span><span>: </span><span class="type-name">Double</span><span>): </span><span class="type-name">Double</span><span> =
  </span><span class="identifier">x</span><span> + </span><span class="number-literal">0.2</span><span>

</span><span class="identifier">rootMeanSquareDeviation</span><span>[</span><span class="type-name">List</span><span>, </span><span class="type-name">Double</span><span>](</span><span class="identifier">data</span><span>, </span><span class="identifier">estimator</span><span>)
</span><span class="comment">// res21: Double = 0.4000000000000002</span></code></pre>
        
        <h2 id="reservoir-sampling" class="section"><a class="anchor-link left" href="#reservoir-sampling"><i class="icofont-laika">&#xef71;</i></a>Reservoir Sampling</h2>
        <p>Reservoir Sampling is the answer to a common interview question.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">random</span><span>.</span><span class="type-name">Generator</span><span>.</span><span class="identifier">rng</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="type-name">Field</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">stats</span><span>.</span><span class="identifier">_</span></code></pre>
        <p>Demonstrate it uniformly sampling 15 of the first 100 integers</p>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">sample</span><span> = </span><span class="identifier">reservoirSampleK</span><span>(</span><span class="number-literal">15</span><span>, </span><span class="type-name">LazyList</span><span>.</span><span class="identifier">from</span><span>(</span><span class="number-literal">1</span><span>), </span><span class="identifier">rng</span><span>).</span><span class="identifier">drop</span><span>(</span><span class="number-literal">100</span><span>).</span><span class="identifier">head</span><span>
</span><span class="comment">// sample: List[Int] = List(
//   88,
//   86,
//   81,
//   78,
//   74,
//   65,
//   63,
//   57,
//   54,
//   48,
//   43,
//   41,
//   35,
//   33,
//   2
// )</span></code></pre>
        <p>The mean of the sample should be in the ballpark of the mean of the entire list (50.5):</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">math</span><span>.</span><span class="identifier">arithmeticMean</span><span>

</span><span class="identifier">arithmeticMean</span><span>(</span><span class="identifier">sample</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">_</span><span>.</span><span class="identifier">toDouble</span><span>))
</span><span class="comment">// res23: Double = 56.53333333333333</span></code></pre>
        <p>Indeed it is.</p>
        
        <h2 id="information-theory" class="section"><a class="anchor-link left" href="#information-theory"><i class="icofont-laika">&#xef71;</i></a>Information Theory</h2>
        
        <h3 id="entropy" class="section"><a class="anchor-link left" href="#entropy"><i class="icofont-laika">&#xef71;</i></a>Entropy</h3>
        <p>The calculation of the entropy of a distribution is available as a function called <code>entropy</code>
        as well as the traditional <code>H</code>:</p>
        <p>Imports and implicits</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">edu</span><span>.</span><span class="identifier">uci</span><span>.</span><span class="identifier">ics</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">graph</span><span>.</span><span class="type-name">DirectedSparseGraph</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">math</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">probability</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">stats</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">quanta</span><span>.</span><span class="type-name">Information</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">directedGraphJung</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">data</span><span>.</span><span class="type-name">Coin</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">game</span><span>.</span><span class="type-name">Dice</span><span>.</span><span class="identifier">die</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">informationConverter</span><span> = </span><span class="type-name">Information</span><span>.</span><span class="identifier">converterGraphK2</span><span>[</span><span class="type-name">Double</span><span>, </span><span class="type-name">DirectedSparseGraph</span><span>]</span></code></pre>
        <p>Usage</p>
        <p>Entropy of fair 6-sided die</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">d6</span><span> = </span><span class="identifier">die</span><span>(</span><span class="number-literal">6</span><span>)
</span><span class="comment">// d6: ConditionalProbabilityTable[Int, Rational] = ConditionalProbabilityTable(
//   p = HashMap(5 -&gt; 1/6, 1 -&gt; 1/6, 6 -&gt; 1/6, 2 -&gt; 1/6, 3 -&gt; 1/6, 4 -&gt; 1/6)
// )
</span><span>
</span><span class="type-name">H</span><span>[</span><span class="type-name">Int</span><span>, </span><span class="type-name">Rational</span><span>](</span><span class="identifier">d6</span><span>).</span><span class="identifier">show</span><span>
</span><span class="comment">// res25: String = &quot;2.5849625007211565 b&quot;</span></code></pre>
        <p>Entropy of fair and biased coins</p>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">fairCoin</span><span> = </span><span class="type-name">Coin</span><span>.</span><span class="identifier">flipModel</span><span>()
</span><span class="comment">// fairCoin: ConditionalProbabilityTable[Symbol, Rational] = ConditionalProbabilityTable(
//   p = Map(&#39;HEAD -&gt; 1/2, &#39;TAIL -&gt; 1/2)
// )
</span><span>
</span><span class="type-name">H</span><span>[</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Rational</span><span>](</span><span class="identifier">fairCoin</span><span>).</span><span class="identifier">show</span><span>
</span><span class="comment">// res26: String = &quot;1.0 b&quot;
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">biasedCoin</span><span> = </span><span class="type-name">Coin</span><span>.</span><span class="identifier">flipModel</span><span>(</span><span class="type-name">Rational</span><span>(</span><span class="number-literal">7</span><span>, </span><span class="number-literal">10</span><span>))
</span><span class="comment">// biasedCoin: ConditionalProbabilityTable[Symbol, Rational] = ConditionalProbabilityTable(
//   p = Map(&#39;HEAD -&gt; 7/10, &#39;TAIL -&gt; 3/10)
// )
</span><span>
</span><span class="identifier">entropy</span><span>[</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Rational</span><span>](</span><span class="identifier">biasedCoin</span><span>).</span><span class="identifier">show</span><span>
</span><span class="comment">// res27: String = &quot;0.8812908992306927 b&quot;</span></code></pre>
        <p>See also the following example of the entropy of a biased coin.</p>
        
        <h3 id="example-entropy-of-a-biased-coin" class="section"><a class="anchor-link left" href="#example-entropy-of-a-biased-coin"><i class="icofont-laika">&#xef71;</i></a>Example: Entropy of a Biased Coin</h3>
        <p>Visualize the relationship of a coin&#39;s bias to its entropy with this code snippet.</p>
        <p>Imports and implicits:</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">scala</span><span>.</span><span class="identifier">collection</span><span>.</span><span class="identifier">immutable</span><span>.</span><span class="type-name">TreeMap</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">math</span><span>.</span><span class="type-name">Rational</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">algebra</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">stats</span><span>.</span><span class="type-name">H</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">data</span><span>.</span><span class="type-name">Coin</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">quanta</span><span>.</span><span class="type-name">UnittedQuantity</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">quanta</span><span>.</span><span class="type-name">Information</span><span>

</span><span class="keyword">type</span><span> </span><span class="type-name">D</span><span> = </span><span class="type-name">TreeMap</span><span>[</span><span class="type-name">Rational</span><span>, </span><span class="type-name">UnittedQuantity</span><span>[</span><span class="type-name">Information</span><span>, </span><span class="type-name">Double</span><span>]]

</span><span class="keyword">import</span><span> </span><span class="identifier">edu</span><span>.</span><span class="identifier">uci</span><span>.</span><span class="identifier">ics</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">graph</span><span>.</span><span class="type-name">DirectedSparseGraph</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">directedGraphJung</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">kernel</span><span>.</span><span class="type-name">Order</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">quanta</span><span>.</span><span class="identifier">unittedTics</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">id</span><span> = {
  </span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span><span>
  </span><span class="type-name">Information</span><span>.</span><span class="identifier">converterGraphK2</span><span>[</span><span class="type-name">Double</span><span>, </span><span class="type-name">DirectedSparseGraph</span><span>]
}

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">or</span><span>: </span><span class="type-name">Order</span><span>[</span><span class="type-name">Rational</span><span>] = </span><span class="keyword">new</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">kernel</span><span>.</span><span class="type-name">Order</span><span>[</span><span class="type-name">Rational</span><span>] {
  </span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">doubleOrder</span><span> = </span><span class="type-name">Order</span><span>.</span><span class="identifier">fromOrdering</span><span>[</span><span class="type-name">Double</span><span>]
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">compare</span><span>(</span><span class="identifier">x</span><span>: </span><span class="type-name">Rational</span><span>, </span><span class="identifier">y</span><span>: </span><span class="type-name">Rational</span><span>): </span><span class="type-name">Int</span><span> = </span><span class="identifier">doubleOrder</span><span>.</span><span class="identifier">compare</span><span>(</span><span class="identifier">x</span><span>.</span><span class="identifier">toDouble</span><span>, </span><span class="identifier">y</span><span>.</span><span class="identifier">toDouble</span><span>)
}
</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">bitDouble</span><span> = </span><span class="identifier">id</span><span>.</span><span class="identifier">bit</span></code></pre>
        <p>Create dataset</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">hm</span><span>: </span><span class="type-name">D</span><span> =
  </span><span class="keyword">new</span><span> </span><span class="type-name">TreeMap</span><span>[</span><span class="type-name">Rational</span><span>, </span><span class="type-name">UnittedQuantity</span><span>[</span><span class="type-name">Information</span><span>, </span><span class="type-name">Double</span><span>]]() ++
    (</span><span class="number-literal">0</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">100</span><span>).</span><span class="identifier">map</span><span>({ </span><span class="identifier">i</span><span> =&gt;
      </span><span class="keyword">val</span><span> </span><span class="identifier">r</span><span> = </span><span class="type-name">Rational</span><span>(</span><span class="identifier">i</span><span>.</span><span class="identifier">toLong</span><span>, </span><span class="number-literal">100L</span><span>)
      </span><span class="identifier">r</span><span> -&gt; </span><span class="type-name">H</span><span>[</span><span class="type-name">Symbol</span><span>, </span><span class="type-name">Rational</span><span>](</span><span class="type-name">Coin</span><span>.</span><span class="identifier">flipModel</span><span>(</span><span class="identifier">r</span><span>))
    }).</span><span class="identifier">toMap</span></code></pre>
        <p>Define visualization</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">visualize</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">fieldDouble</span><span>: </span><span class="type-name">Field</span><span>[</span><span class="type-name">Double</span><span>] = </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="type-name">DoubleAlgebra</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">plot</span><span> = </span><span class="type-name">Plot</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">UnittedQuantity</span><span>[</span><span class="type-name">Information</span><span>, </span><span class="type-name">Double</span><span>], </span><span class="type-name">D</span><span>](
  () =&gt; </span><span class="type-name">List</span><span>((</span><span class="string-literal">&quot;h&quot;</span><span>, </span><span class="identifier">hm</span><span>)),
  </span><span class="identifier">connect</span><span> = </span><span class="boolean-literal">true</span><span>,
  </span><span class="identifier">colorOf</span><span> = </span><span class="identifier">_</span><span> =&gt; </span><span class="type-name">Color</span><span>.</span><span class="identifier">black</span><span>,
  </span><span class="identifier">drawKey</span><span> = </span><span class="boolean-literal">false</span><span>,
  </span><span class="identifier">xAxisLabel</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;p(x=&#39;HEAD)&quot;</span><span>),
  </span><span class="identifier">yAxisLabel</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;H&quot;</span><span>),
  </span><span class="identifier">title</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;Entropy&quot;</span><span>)).</span><span class="identifier">zeroAxes</span></code></pre>
        <p>Create the SVG</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">web</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="identifier">_</span><span>

</span><span class="identifier">plot</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/coinentropy.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p>The result is the classic Claude Shannon graph</p>
        <p><img src="/images/coinentropy.svg" alt="coin entropy"></p>
        
        <h2 id="probabilistic-graphical-models" class="section"><a class="anchor-link left" href="#probabilistic-graphical-models"><i class="icofont-laika">&#xef71;</i></a>Probabilistic Graphical Models</h2>
        <p>Currently only Bayesian Networks</p>
        <p>Eventually others including Pearl&#39;s causal models.</p>
        
        <h3 id="bayesian-networks" class="section"><a class="anchor-link left" href="#bayesian-networks"><i class="icofont-laika">&#xef71;</i></a>Bayesian Networks</h3>
        <p>See the Wikipedia page on <a href="https://en.wikipedia.org/wiki/Bayesian_network">Bayesian networks</a></p>
        
        <h3 id="example-alarm" class="section"><a class="anchor-link left" href="#example-alarm"><i class="icofont-laika">&#xef71;</i></a>Example: Alarm</h3>
        <p>Define random variables</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">probability</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">bools</span><span> = </span><span class="type-name">Vector</span><span>(</span><span class="boolean-literal">true</span><span>, </span><span class="boolean-literal">false</span><span>)

</span><span class="keyword">val</span><span> </span><span class="type-name">B</span><span> = </span><span class="type-name">Variable</span><span>[</span><span class="type-name">Boolean</span><span>](</span><span class="string-literal">&quot;Burglary&quot;</span><span>)
</span><span class="keyword">val</span><span> </span><span class="type-name">E</span><span> = </span><span class="type-name">Variable</span><span>[</span><span class="type-name">Boolean</span><span>](</span><span class="string-literal">&quot;Earthquake&quot;</span><span>)
</span><span class="keyword">val</span><span> </span><span class="type-name">A</span><span> = </span><span class="type-name">Variable</span><span>[</span><span class="type-name">Boolean</span><span>](</span><span class="string-literal">&quot;Alarm&quot;</span><span>)
</span><span class="keyword">val</span><span> </span><span class="type-name">J</span><span> = </span><span class="type-name">Variable</span><span>[</span><span class="type-name">Boolean</span><span>](</span><span class="string-literal">&quot;John Calls&quot;</span><span>)
</span><span class="keyword">val</span><span> </span><span class="type-name">M</span><span> = </span><span class="type-name">Variable</span><span>[</span><span class="type-name">Boolean</span><span>](</span><span class="string-literal">&quot;Mary Calls&quot;</span><span>)</span></code></pre>
        <p>Define Factor for each variable</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">math</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">bFactor</span><span> =
  </span><span class="type-name">Factor</span><span>(</span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> -&gt; </span><span class="identifier">bools</span><span>), </span><span class="type-name">Map</span><span>(
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">999</span><span>, </span><span class="number-literal">1000</span><span>)))

</span><span class="keyword">val</span><span> </span><span class="identifier">eFactor</span><span> =
  </span><span class="type-name">Factor</span><span>(</span><span class="type-name">Vector</span><span>(</span><span class="type-name">E</span><span> -&gt; </span><span class="identifier">bools</span><span>), </span><span class="type-name">Map</span><span>(
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">500</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">499</span><span>, </span><span class="number-literal">500</span><span>)))

</span><span class="keyword">val</span><span> </span><span class="identifier">aFactor</span><span> =
  </span><span class="type-name">Factor</span><span>(</span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> -&gt; </span><span class="identifier">bools</span><span>, </span><span class="type-name">E</span><span> -&gt; </span><span class="identifier">bools</span><span>, </span><span class="type-name">A</span><span> -&gt; </span><span class="identifier">bools</span><span>), </span><span class="type-name">Map</span><span>(
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">999</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">940</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">60</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">290</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">710</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">950</span><span>, </span><span class="number-literal">1000</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">B</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">E</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">50</span><span>, </span><span class="number-literal">1000</span><span>)))

</span><span class="keyword">val</span><span> </span><span class="identifier">jFactor</span><span> =
  </span><span class="type-name">Factor</span><span>(</span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> -&gt; </span><span class="identifier">bools</span><span>, </span><span class="type-name">J</span><span> -&gt; </span><span class="identifier">bools</span><span>), </span><span class="type-name">Map</span><span>(
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">J</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">9</span><span>, </span><span class="number-literal">10</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">J</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">10</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">J</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">5</span><span>, </span><span class="number-literal">100</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">J</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">95</span><span>, </span><span class="number-literal">100</span><span>)))

</span><span class="keyword">val</span><span> </span><span class="identifier">mFactor</span><span> =
  </span><span class="type-name">Factor</span><span>(</span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> -&gt; </span><span class="identifier">bools</span><span>, </span><span class="type-name">M</span><span> -&gt; </span><span class="identifier">bools</span><span>), </span><span class="type-name">Map</span><span>(
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">M</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">7</span><span>, </span><span class="number-literal">10</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>, </span><span class="type-name">M</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">3</span><span>, </span><span class="number-literal">10</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">M</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">true</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="number-literal">100</span><span>),
    </span><span class="type-name">Vector</span><span>(</span><span class="type-name">A</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>, </span><span class="type-name">M</span><span> </span><span class="identifier">is</span><span> </span><span class="boolean-literal">false</span><span>) -&gt; </span><span class="type-name">Rational</span><span>(</span><span class="number-literal">99</span><span>, </span><span class="number-literal">100</span><span>)))</span></code></pre>
        <p>Arrange into a graph</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">pgm</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">edu</span><span>.</span><span class="identifier">uci</span><span>.</span><span class="identifier">ics</span><span>.</span><span class="identifier">jung</span><span>.</span><span class="identifier">graph</span><span>.</span><span class="type-name">DirectedSparseGraph</span><span>

</span><span class="comment">// edges: ba, ea, aj, am
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">bn</span><span>: </span><span class="type-name">BayesianNetwork</span><span>[</span><span class="type-name">Boolean</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">DirectedSparseGraph</span><span>[</span><span class="type-name">BayesianNetworkNode</span><span>[</span><span class="type-name">Boolean</span><span>, </span><span class="type-name">Rational</span><span>], </span><span class="type-name">Edge</span><span>]] =
  </span><span class="type-name">BayesianNetwork</span><span>.</span><span class="identifier">withGraphK2</span><span>[</span><span class="type-name">Boolean</span><span>, </span><span class="type-name">Rational</span><span>, </span><span class="type-name">DirectedSparseGraph</span><span>](
    </span><span class="type-name">Map</span><span>(
      </span><span class="type-name">B</span><span> -&gt; </span><span class="identifier">bFactor</span><span>,
      </span><span class="type-name">E</span><span> -&gt; </span><span class="identifier">eFactor</span><span>,
      </span><span class="type-name">A</span><span> -&gt; </span><span class="identifier">aFactor</span><span>,
      </span><span class="type-name">J</span><span> -&gt; </span><span class="identifier">jFactor</span><span>,
      </span><span class="type-name">M</span><span> -&gt; </span><span class="identifier">mFactor</span><span>))</span></code></pre>
        <p>Create an SVG visualization</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">visualize</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">bnVis</span><span>  = </span><span class="type-name">BayesianNetworkVisualization</span><span>(</span><span class="identifier">bn</span><span>, </span><span class="number-literal">1000</span><span>, </span><span class="number-literal">1000</span><span>, </span><span class="number-literal">20</span><span>)</span></code></pre>
        <p>Render as SVG file</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">web</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="identifier">_</span><span>

</span><span class="identifier">bnVis</span><span>.</span><span class="identifier">svg</span><span>[</span><span class="type-name">IO</span><span>](</span><span class="string-literal">&quot;docwork/images/alarm_bayes.svg&quot;</span><span>).</span><span class="identifier">unsafeRunSync</span><span>()</span></code></pre>
        <p><img src="/images/alarm_bayes.svg" alt="alarm bayes network"></p>
        <p>The network can be used to compute the joint probability table:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">math</span><span>.</span><span class="identifier">showRational</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">jpt</span><span> = </span><span class="identifier">bn</span><span>.</span><span class="identifier">jointProbabilityTable</span></code></pre>
        <pre><code class="nohighlight"><span class="identifier">jpt</span><span>.</span><span class="identifier">show</span><span>
</span><span class="comment">// res32: String = &quot;&quot;&quot;John Calls Alarm Earthquake Burglary Mary Calls
// true       true  true       true     true       1197/1000000000
// true       true  true       true     false      513/1000000000
// true       true  true       false    true       1825173/5000000000
// true       true  true       false    false      782217/5000000000
// true       true  false      true     true       1477539/2500000000
// true       true  false      true     false      633231/2500000000
// true       true  false      false    true       31405563/50000000000
// true       true  false      false    false      13459527/50000000000
// true       false true       true     true       1/20000000000
// true       false true       true     false      99/20000000000
// true       false true       false    true       70929/100000000000
// true       false true       false    false      7021971/100000000000
// true       false false      true     true       1497/50000000000
// true       false false      true     false      148203/50000000000
// true       false false      false    true       498002499/1000000000000
// true       false false      false    false      49302247401/1000000000000
// false      true  true       true     true       133/1000000000
// false      true  true       true     false      57/1000000000
// false      true  true       false    true       202797/5000000000
// false      true  true       false    false      86913/5000000000
// false      true  false      true     true       164171/2500000000
// false      true  false      true     false      70359/2500000000
// false      true  false      false    true       3489507/50000000000
// false      true  false      false    false      1495503/50000000000
// false      false true       true     true       19/20000000000
// false      false true       true     false      1881/20000000000
// false      false true       false    true       1347651/100000000000
// false      false true       false    false      133417449/100000000000
// false      false false      true     true       28443/50000000000
// false      false false      true     false      2815857/50000000000
// false      false false      false    true       9462047481/1000000000000
// false      false false      false    false      936742700619/1000000000000&quot;&quot;&quot;</span></code></pre>
        <p>Variables can be summed out of the factor:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">axle</span><span>.</span><span class="identifier">_</span><span>

</span><span class="identifier">jpt</span><span>.</span><span class="identifier">sumOut</span><span>(</span><span class="type-name">M</span><span>).</span><span class="identifier">sumOut</span><span>(</span><span class="type-name">J</span><span>).</span><span class="identifier">sumOut</span><span>(</span><span class="type-name">A</span><span>).</span><span class="identifier">sumOut</span><span>(</span><span class="type-name">B</span><span>).</span><span class="identifier">sumOut</span><span>(</span><span class="type-name">E</span><span>)
</span><span class="comment">// res33: Factor[Boolean, Rational] = Factor(
//   variablesWithValues = Vector(),
//   probabilities = Map(Vector() -&gt; 1)
// )</span></code></pre>
        <p>Also written as:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">jpt</span><span>.Î£(</span><span class="type-name">M</span><span>).Î£(</span><span class="type-name">J</span><span>).Î£(</span><span class="type-name">A</span><span>).Î£(</span><span class="type-name">B</span><span>).Î£(</span><span class="type-name">E</span><span>)
</span><span class="comment">// res34: Factor[Boolean, Rational] = Factor(
//   variablesWithValues = Vector(),
//   probabilities = Map(Vector() -&gt; 1)
// )</span></code></pre>
        <p>Multiplication of factors also works:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">spire</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">multiplicativeSemigroupOps</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">f</span><span> = (</span><span class="identifier">bn</span><span>.</span><span class="identifier">factorFor</span><span>(</span><span class="type-name">A</span><span>) * </span><span class="identifier">bn</span><span>.</span><span class="identifier">factorFor</span><span>(</span><span class="type-name">B</span><span>)) * </span><span class="identifier">bn</span><span>.</span><span class="identifier">factorFor</span><span>(</span><span class="type-name">E</span><span>)</span></code></pre>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">f</span><span>.</span><span class="identifier">show</span><span>
</span><span class="comment">// res35: String = &quot;&quot;&quot;Burglary Earthquake Alarm
// true     true       true  19/10000000
// true     true       false 1/10000000
// true     false      true  23453/25000000
// true     false      false 1497/25000000
// false    true       true  28971/50000000
// false    true       false 70929/50000000
// false    false      true  498501/500000000
// false    false      false 498002499/500000000&quot;&quot;&quot;</span></code></pre>
        <p>Markov assumptions:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">bn</span><span>.</span><span class="identifier">markovAssumptionsFor</span><span>(</span><span class="type-name">M</span><span>).</span><span class="identifier">show</span><span>
</span><span class="comment">// res36: String = &quot;I({Mary Calls}, {Alarm}, {John Calls, Earthquake, Burglary})&quot;</span></code></pre>
        <p>This is read as &quot;M is independent of E, B, and J given A&quot;.</p>
        
        <h2 id="probability-model-future-work" class="section"><a class="anchor-link left" href="#probability-model-future-work"><i class="icofont-laika">&#xef71;</i></a>Probability Model Future Work</h2>
        
        <h3 id="later" class="section"><a class="anchor-link left" href="#later"><i class="icofont-laika">&#xef71;</i></a>Later</h3>
        <ul>
          <li>
            <p><code>{CPT,TD}.tailRecM</code> then ScalaCheck <code>Monad[CPT,TD]</code></p>
          </li>
          <li>
            <p>Functor for CPT, TD</p>
          </li>
          <li>
            <p><code>SigmaAlgebra</code> for the CPT</p>
          </li>
        </ul>
        <ul>
          <li>Clean up expressions like <code>RegionIf[TWOROLLS](_._1 == &#39;âšƒ)</code></li>
        </ul>
        <ul>
          <li>Laws for <code>Region</code> (&quot;Sigma Algebra&quot;? <a href="https://www.youtube.com/watch?v=21a85f1YS5Q">video</a>)</li>
        </ul>
        <ul>
          <li>
            <p><code>OrderedRegion</code> for the <code>Order</code> used in <code>RegionLTE</code> and <code>RegionGTE</code>?</p>
          </li>
          <li>
            <p>Measure Theory</p>
          </li>
          <li>
            <p>Test: start with <code>ABE.jointProbabilityTable</code> (monotype <code>tuple5[Boolean]</code>)</p>
          </li>
        </ul>
        <ul>
          <li>Factor out each variable until original 5-note network is reached</li>
        </ul>
        <ul>
          <li>Basically the inverse of factor multiplication</li>
        </ul>
        <ul>
          <li><code>bn.factorFor(B) * bn.factorFor(E)</code> should be defined? (It errors)</li>
        </ul>
        <ul>
          <li>
            <p><code>MonotypeBayesanNetwork.filter</code> collapase into a single BNN</p>
          </li>
          <li>
            <p>Rename <code>ConditionalProbabilityTable</code>?</p>
          </li>
          <li>
            <p>Laws for <code>Factor</code></p>
          </li>
          <li>
            <p>Review <code>InteractionGraph</code>, <code>EliminationGraph</code>, <code>JoinTree</code> and the functions they power</p>
          </li>
          <li>
            <p>Consider a &quot;case&quot; to be a <code>Map</code> vs a <code>Vector</code></p>
          </li>
          <li>
            <p>Consider usefulness of <code>Factor</code> in terms of <code>Region</code></p>
          </li>
          <li>
            <p><code>MonotypeBayesanNetwork</code>.{<code>pure</code>, <code>map</code>, <code>flatMap</code>, <code>tailRecR</code>}</p>
          </li>
          <li>
            <p>Reconcile <code>MBN</code> <code>combine1</code> &amp; <code>combine2</code></p>
          </li>
          <li>
            <p>Monad tests for <code>MonotypeBayesanNetwork[Alarm-Burglary-Earthquake]</code></p>
          </li>
          <li>
            <p><code>Bayes[MonotypeBayesanNetwork]</code> -- could be viewed as &quot;belief updating&quot; (vs &quot;conditioning&quot;)</p>
          </li>
        </ul>
        <ul>
          <li>
            <p>If it took a ProbabilityModel itself</p>
          </li>
          <li>
            <p>Bettings odds</p>
          </li>
          <li>
            <p>Multi-armed bandit</p>
          </li>
          <li>
            <p>Recursive grid search</p>
          </li>
          <li>
            <p>P-values</p>
          </li>
          <li>
            <p>z &amp; t scores</p>
          </li>
          <li>
            <p>Correlation</p>
          </li>
          <li>
            <p>Regression</p>
          </li>
          <li>
            <p>Accuracy, Precision</p>
          </li>
          <li>
            <p>Bias, Variance</p>
          </li>
          <li>
            <p>Cohen&#39;s Kappa</p>
          </li>
          <li>
            <p>Rm throws from axle.stats.TallyDistribution</p>
          </li>
          <li>
            <p>do-calculus (Causality)</p>
          </li>
          <li>
            <p>Stochastic Lambda Calculus</p>
          </li>
          <li>
            <p>Abadi Plotkin pathology</p>
          </li>
          <li>
            <p>Jacobian Vector Products (JVP)</p>
          </li>
          <li>
            <p>FLDR probability</p>
          </li>
        </ul>
        <ul>
          <li><a href="https://github.com/probcomp/fast-loaded-dice-roller/">probcomp github</a></li>
        </ul>
        <ul>
          <li><a href="http://fsaad.mit.edu/assets/2020-08-20-fldr-slides.pdf">MIT FSAAD slides</a></li>
        </ul>
        
        <h3 id="docs" class="section"><a class="anchor-link left" href="#docs"><i class="icofont-laika">&#xef71;</i></a>Docs</h3>
        <ul>
          <li>Reorder Probability mdoc (Creation, Kolmogorov/Region, Sampler, Bayes, Monad)?</li>
        </ul>
        <ul>
          <li>Footnotes (Giry, etc)</li>
        </ul>

      </main>

    </div>

  </body>
</html>